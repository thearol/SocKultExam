---
title: "DataCleaning"
author: "Signe Kløve Kjær"
date: "2/5/2019"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r loading packages, include = FALSE}

#install.packages("tidybayes"); install.packages("LaplacesDemon")
library(brms); library(tidyverse); library(tidybayes); library(ggplot2); library(LaplacesDemon); library(rethinking); library(tidyr); library(reshape2);library(pacman); library(tibble);library(tidyr) ;library(pacman)

p_load(plotly, jpeg)
```

```{r loading data and merging, include = FALSE}

#Defining path
data_path = ("~/Cognitive Science/4. Semester/Social and Cultural Dynamics Exam/SocKultExam/Data/") #Kiri

#data_path = ("~/Data") #Thea

#Listing files in path
files <- list.files(path = data_path)

#Create empty data frame
data <- data.frame(matrix(ncol = 36, nrow = 0))

#Looping through data files and inserting in dataframe
for (i in files) {
  d <- read.delim(file = paste(data_path, i, sep = ""), sep = ",", header = TRUE)
  data = rbind(data,d)
}

#Kiris data

#Setting different path for extraordinary files
#kiri_path = ("~/SocKultExam/") #Thea
kiri_path = ("~/Cognitive Science/4. Semester/Social and Cultural Dynamics Exam/SocKultExam/")#Kiri
kiri_files <- list.files(path = kiri_path, pattern = "*.csv") #Listing files in directory

kiri_data <- data.frame(matrix(ncol = 35, nrow = 0))#Creating empty data frame for Kiri data

#Looping through Kiri data 
for (i in kiri_files) {
  d <- read.delim(file = paste(kiri_path, i, sep = ""), sep = ",", header = TRUE, stringsAsFactors = FALSE)
  kiri_data = rbind(kiri_data, d)
}


#merge the two dataframes
kiri_data <- add_column(kiri_data, Computer = "Two screens", .after = 4)
data <- rbind(data, kiri_data)

```

```{r cleaning data, include = FALSE}

#Removing column of x
data <- subset(data, select = -c(X))

#Cleaning group numbers
data$GroupNumber[data$GroupNumber == "17_10_30"] <- 17
data$GroupNumber[data$GroupNumber == "18_10_30"] <- 18
data$GroupNumber[data$GroupNumber == "19_10_50"] <- 19
data$GroupNumber[data$GroupNumber == "20_10_50"] <- 20
data$GroupNumber[data$GroupNumber == "21_12_15"] <- 21
data$GroupNumber[data$GroupNumber == "22_12_15"] <- 22
data$GroupNumber[data$GroupNumber == "23_12_40"] <- 23
data$GroupNumber[data$GroupNumber == "24_12_40"] <- 24
data$GroupNumber[data$GroupNumber == "25_15_00"] <- 25
data$GroupNumber[data$GroupNumber == "26_15_00"] <- 26
data$GroupNumber[data$GroupNumber == "27_15_20"] <- 27
data$GroupNumber[data$GroupNumber == "28_15_20"] <- 28
data$GroupNumber[data$GroupNumber == "29_16_00"] <- 29
data$GroupNumber[data$GroupNumber == "30_16_00"] <- 30
data$GroupNumber[data$GroupNumber == "31_16_20"] <- 31
data$GroupNumber[data$GroupNumber == "32_16_20"] <- 32
data$GroupNumber[data$GroupNumber == "33_9_30"] <- 33
data$GroupNumber[data$GroupNumber == "34_09_30"] <- 34
data$GroupNumber[data$GroupNumber == "35_09_50"] <- 35
data$GroupNumber[data$GroupNumber == "36_9_50"] <- 36
data$GroupNumber[data$GroupNumber == "37_26_4"] <- 37
data$GroupNumber[data$GroupNumber == "38_26_4"] <- 38
data$GroupNumber[data$GroupNumber == "39_26_4"] <- 39
data$GroupNumber[data$GroupNumber == "40_26_4"] <- 40

#Cleaning subject IDs
data$SubjectID_left <- as.character(data$SubjectID_left)
data$SubjectID_right <- as.character(data$SubjectID_right)
data$SubjectID_left[data$SubjectID_left == "steph"] <- "stephanie"
data$SubjectID_right[data$SubjectID_right == "Emil"] <- "emil"
data$SubjectID_right[data$SubjectID_right == "Sebber"] <- "seb"
data$SubjectID_left[data$SubjectID_left == "signe"] <- "SigneR"
data$SubjectID_right[data$SubjectID_right == "karo"] <- "Karoline"
data$SubjectID_right[data$SubjectID_right == "tobias"] <- "Toby"
data$SubjectID_left[data$SubjectID_left == "Nina"] <- "nina"
data$SubjectID_right[data$SubjectID_right == "theasmom"] <- "Theasmom"
data$SubjectID_left[data$SubjectID_left == "emma"] <- "Emma"
data$SubjectID_right[data$SubjectID_right == "LasseKob"] <- "Lasse"

```


```{r making variables for sensitivty, include = FALSE}
#Making unique subjects
data$unique_ID_right <- paste(data$GroupNumber, data$SubjectID_right, sep = "_")
data$unique_ID_left <- paste(data$GroupNumber, data$SubjectID_left, sep = "_")

#Making column, which expresses difficulty
data$dif_blue <- data$Prop_blue_image_2 - data$Prop_blue_image_1
data$dif_blue_abs <- abs(data$Prop_blue_image_2 - data$Prop_blue_image_1)

#Making a column, which expresses answer of participants, 0 = left picture, 1 = right picture
data$right_answer <- ifelse(data$Response_right > 0, 1, 0)
data$left_answer <- ifelse(data$Response_left > 0, 1, 0)

#Joining joint answer to one column
data$joint_answer <- data$Joint_right+ data$Joint_left

#Recoding joint answer to be 0 and 1's, 0 right, 1 left, NA = no leader
data$joint_answer[data$joint_answer == 0] <- NA #Replacing 0's with NA
data$joint_answer[data$joint_answer == -1] <- 0
```


```{r coding for leader/follower}

#create a column that sorts out all the agreed trials
data$chosen_leader <- ifelse(data$right_answer == data$left_answer, "Agree", 0) 

#Create variable, which determines the chosen leader
data$chosen_leader[data$chosen_leader == 0 & data$Joint_right == 0] <- "Left_lead"
data$chosen_leader[data$chosen_leader == 0 & data$Joint_left == 0] <- "Right_lead"

#create column that specifies the gender of the leader
data$Leader_gender <- 0
data$Leader_gender <- ifelse(data$chosen_leader == "Left_lead", as.character(data$Gender_left), as.character(data$Gender_right))
data$Leader_gender[data$chosen_leader == "Agree"] <- NA

#create column that specifies the gender of the follower
data$Follower_gender <- 0
data$Follower_gender <- ifelse(data$chosen_leader == "Left_lead", as.character(data$Gender_right), as.character(data$Gender_left))
data$Follower_gender[data$chosen_leader == "Agree"] <- NA

```


```{r Did the leader stick?}

#leader stubbornness
data$Stubborn_leader <- 0 #Creating column of 0's

data$Stubborn_leader[data$chosen_leader == "Right_lead" & data$joint_answer == data$right_answer] <- "stick" #Inserting cases were leader stick for right leader
data$Stubborn_leader[data$chosen_leader == "Right_lead" & data$joint_answer != data$right_answer] <- "surrender" #Inserting cases were leader surrender for right leader

data$Stubborn_leader[data$chosen_leader == "Left_lead" & data$joint_answer == data$left_answer] <- "stick" #Inserting cases were leader stick for left leader
data$Stubborn_leader[data$chosen_leader == "Left_lead" & data$joint_answer != data$left_answer] <- "surrender" #Inserting cases were leader surreder for left leader

data$Stubborn_leader[data$chosen_leader == "Agree"] <- NA #Removing cases were they agree


```


```{r Plotting the effect of stick or surrender, leader and follower gender}
#Filtering data to include only joint decisions
disagree_data <- na.omit(data)

#Making column specifying the leader and follower gender
disagree_data$Leader_Follower <- paste("Leader:", disagree_data$Leader_gender, "_Follower:", disagree_data$Follower_gender, sep = "")

#Recoding stick to 0 and 1, stick = 1, 0 = surrender
disagree_data$stick <- ifelse(disagree_data$Stubborn_leader == "stick", 1, 0)

#Plotting the count 
ggplot(data = disagree_data, aes(Stubborn_leader, fill = Stubborn_leader)) +
  facet_grid(~Leader_Follower) +
  geom_histogram(stat = "count")



```




Bayesian tutorial on logistic regression: https://www.jamesrrae.com/post/bayesian-logistic-regression-using-brms-part-1/

#NO POOLING

###Individual performance

```{r logistic regression using wide format, individual left}

###LEFT

#Getting priors
get_prior(left_answer ~ dif_blue, data = data)

#Making a number of iterations variable
n = 1

###Making a loop for individual slope
for (i in unique(data$unique_ID_left)){
  data_i <- filter(data, unique_ID_left == i) #Choosing temporary data
  
  #Defining paths for plots
  trans_left_path = file.path("~/SocKultExam/plots/transition/left/", paste("trans_left_plot_", i, ".jpeg", sep = ""))
  pp_left_path = file.path("~/SocKultExam/plots/pp_check/left/", paste("pp_left_plot_",i, ".jpeg", sep = ""))
  marginal_left_path = file.path("~/SocKultExam/plots/marginal/left/", paste("marginal_left_plot_", i, ".jpeg", sep = ""))
  
  #Defining priors
  prior =  c(
  prior(normal(0,2), class = "Intercept"), 
  #prior(normal(0,2), class = "sigma"), #Why does this not work? 
  prior(normal(0,2), class = "b"), 
  prior(normal(0,1), class = "b", coef = "dif_blue"))
  
  #Prior predictive check
  prior_check <- brm( left_answer ~ dif_blue, prior = prior,
           data = data_i, sample_prior = "only",iter = 4000, family = "bernoulli")
  

 
  #Making the model - using answer
  m <- brm(
    left_answer ~ dif_blue,
    data = data_i,
    prior = prior,
    family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
    seed = 123 # Adding a seed makes results reproducible.
  ) 
 
  
  #Making the model - using correctness
  m_c <- brm(
    Correct_left ~ dif_blue_abs,
    data = data_i,
    prior = prior,
    family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
    seed = 123 # Adding a seed makes results reproducible.
  ) 
 
  
   
  #Marginal effects plot: Plotted and saved
  jpeg(file=marginal_left_path)
  print(marginal_effects(m))
  dev.off()
  
  #Transition plot: plotted and saved
   jpeg(file=trans_left_path)
   print(plot(m))
   dev.off()

  #pp_check plot: Plotted and saved
   jpeg(file=pp_left_path)
   print(pp_check(prior_check, nsamples = 100))
   dev.off()
  
   summary(m)
  
  #Saving summary in temporary dataframe
  data_i$Est_int_left <- fixef(m)[1]
  data_i$Error_int_left <- fixef(m)[3]
  data_i$Est_dif_blue_left <- fixef(m)[2]
  data_i$Error_dif_blue_left <- fixef(m)[4]
  data_i$Est_int_left_correct <- fixef(m_c)[1]
  data_i$Error_int_left_correct <- fixef(m_c)[3]
  data_i$Est_dif_blue_left_correct <- fixef(m_c)[2]
  data_i$Error_dif_blue_left_correct <- fixef(m_c)[4]
  data_i$Rhat_1_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[1]]
  data_i$Rhat_2_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[2]]
  data_i$Rhat_3_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[3]] #Why are there three? 
  data_i$Ess_1_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[1]]
  data_i$Ess_2_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[2]]
  data_i$Ess_3_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[3]] #Why are there three? 
  
  #Insert into permanent data frame
  if (n == 1){
    Results <- data_i
  } else {
    Results <- rbind(Results, data_i)
  }

  #Adding 1 to number of iterations
n = n + 1
  
}

```

```{r skal slettes}

data_i <- filter(data, unique_ID_right == "10_simonmoller")

trans_left_path = file.path("~/SocKultExam/plots/transition/left/", paste("trans_left_plot_", ".jpeg", sep = ""))
trans_right_path = file.path("~/SocKultExam/plots/transition/right/", paste("trans_right_plot_", ".jpeg", sep = ""))
trans_joint_path = file.path("~/SocKultExam/plots/transition/joint/", paste("trans_joint_plot_", ".jpeg", sep = ""))

pp_left_path = file.path("~/SocKultExam/plots/pp_check/left/", paste("pp_left_plot_", ".jpeg", sep = ""))
pp_right_path = file.path("~/SocKultExam/plots/pp_check/right/", paste("pp_right_plot_", ".jpeg", sep = ""))
pp_joint_path = file.path("~/SocKultExam/plots/pp_check/joint/", paste("pp_joint_plot_", ".jpeg", sep = ""))

#Defining priors
prior =  c(
prior(normal(0,2), class = "Intercept"), #How to motiavte this?
#prior(normal(0,2), class = "sigma"), #Roughly on the same scale
prior(normal(0,2), class = "b"), #How to motiavte this?
prior(normal(0,1), class = "b", coef = "dif_blue"))
  
  #Prior predictive check
prior_check <- brm( left_answer ~ dif_blue, prior = prior,
         data = data_i, sample_prior = "only",iter = 4000, family = "bernoulli")



 
  #Making the model
m <- brm(
  left_answer ~ dif_blue,
  data = data_i,
  prior = prior,
  family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
  seed = 123 # Adding a seed makes results reproducible.
) 
  
summary(m)
jpeg(file=pp_left_path)
marginal_effects(m)
dev.off()

#trans plot
jpeg(file=pp_left_path)
plot(m)
dev.off()

#pp_check plot
jpeg(file=pp_left_path)
pp_check(prior_check, nsamples = 100)
dev.off()

data_i$Est_int_left <- fixef(m)[1]
data_i$Error_int_left <- fixef(m)[3]
data_i$Est_dif_blue_left <- fixef(m)[2]
data_i$Error_dif_blue_left <- fixef(m)[4]
data_i$Rhat_1_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[1]]
data_i$Rhat_2_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[2]]
data_i$Rhat_3_left <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[3]]
data_i$Ess_1_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[1]]
data_i$Ess_2_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[2]]
data_i$Ess_3_left <- m[["fit"]]@.MISC[["summary"]][["ess"]][[3]]



```

```{r logistic regression using wide format, individual right}
###RIGHT

#Making a number of iterations variable
n = 1

###Making a loop for individual slope
for (i in unique(data$unique_ID_right)){
  data_i <- filter(Results, unique_ID_right == i)
  
  #Defining paths for plots
  trans_right_path = file.path("~/SocKultExam/plots/transition/right/", paste("trans_right_plot_", i, ".jpeg", sep = ""))
  pp_right_path = file.path("~/SocKultExam/plots/pp_check/right/", paste("pp_right_plot_",i, ".jpeg", sep = ""))
  marginal_right_path = file.path("~/SocKultExam/plots/marginal/right/", paste("marginal_right_plot_", i, ".jpeg", sep = ""))
  
  
  #Defining priors
  prior =  c(
  prior(normal(0,2), class = "Intercept"), 
  #prior(normal(0,2), class = "sigma"), #Why doesn't this work?
  prior(normal(0,2), class = "b"), 
  prior(normal(0,1), class = "b", coef = "dif_blue"))
  
  #Prior predictive check
  prior_check <- brm( right_answer ~ dif_blue, prior = prior,
           data = data_i, sample_prior = "only",iter = 4000, family = "bernoulli")
 
  #Making the model
  m <- brm(
    right_answer ~ dif_blue,
    data = data_i,
    prior = prior,
    family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
    seed = 123 # Adding a seed makes results reproducible.
  ) 
  
  #Marginal effects plot: Plotted and saved
  jpeg(file=marginal_right_path)
  print(marginal_effects(m))
  dev.off()
    
  
  #transition plot: Plotted and saved
  jpeg(file=trans_right_path)
  print(plot(m))
  dev.off()

  #pp_check plot: Plotted and saved
  jpeg(file=pp_right_path)
  print(pp_check(prior_check, nsamples = 100))
  dev.off()
  
  summary(m)
  
  
  #Saving summary in temporary dataframe
  data_i$Est_int_right <- fixef(m)[1]
  data_i$Error_int_right <- fixef(m)[3]
  data_i$Est_dif_blue_right <- fixef(m)[2]
  data_i$Error_dif_blue_right <- fixef(m)[4]
  data_i$Rhat_1_right <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[1]]
  data_i$Rhat_2_right <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[2]]
  data_i$Rhat_3_right <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[3]] #Why are there three?
  data_i$Ess_1_right <- m[["fit"]]@.MISC[["summary"]][["ess"]][[1]]
  data_i$Ess_2_right <- m[["fit"]]@.MISC[["summary"]][["ess"]][[2]]
  data_i$Ess_3_right <- m[["fit"]]@.MISC[["summary"]][["ess"]][[3]] #Why are there three?
  
  #Insert into permanent data frame
  if (n == 1){
    Results <- data_i
  } else {
    Results <- rbind(Results, data_i)
  }
  
n = n + 1
  
}


```

###Joint performance
```{r logistic regression using wide format, joint}
###JOINT

#Making a number of iterations variable
n = 1

###Making a loop for individual slope
for (i in unique(joint_data$GroupNumber)){
  data_i <- filter(Results, GroupNumber == i)
  
  
  #Defining paths for plots
  trans_right_path = file.path("~/SocKultExam/plots/transition/right/", paste("trans_right_plot_", i, ".jpeg", sep = ""))
  pp_right_path = file.path("~/SocKultExam/plots/pp_check/right/", paste("pp_right_plot_",i, ".jpeg", sep = ""))
  marginal_right_path = file.path("~/SocKultExam/plots/marginal/right/", paste("marginal_right_plot_", i, ".jpeg", sep = ""))
  
  
  #Defining priors
  prior =  c(
  prior(normal(0,2), class = "Intercept"), #How to motiavte this?
  #prior(normal(0,2), class = "sigma"), #Roughly on the same scale
  prior(normal(0,2), class = "b"), #How to motiavte this?
  prior(normal(0,1), class = "b", coef = "dif_blue"))
  
  #Prior predictive check
  prior_check <- brm( joint_answer ~ dif_blue, prior = prior,
           data = data_i, sample_prior = "only",iter = 4000, family = "bernoulli")

 
  #Making the model
  m <- brm(
    joint_answer ~ dif_blue,
    data = data_i,
    prior = prior,
    family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
    seed = 123 # Adding a seed makes results reproducible.
  ) 

  #Marginal plot
  jpeg(file=marginal_right_path)
  print(marginal_effects(m))
  dev.off()
  
  #transition plot: Plotted and saved
  jpeg(file=trans_joint_path)
  print(plot(m))
  dev.off()

  #pp_check plot: Plotted and saved
  jpeg(file=pp_joint_path)
  print(pp_check(prior_check, nsamples = 100))
  dev.off()
  
  summary(m)
  
  #Saving summary in temporary dataframe
  data_i$Est_int_joint <- fixef(m)[1]
  data_i$Error_int_joint <- fixef(m)[3]
  data_i$Est_dif_blue_joint <- fixef(m)[2]
  data_i$Error_dif_blue_joint <- fixef(m)[4]
  data_i$Rhat_1_joint <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[1]]
  data_i$Rhat_2_joint <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[2]]
  data_i$Rhat_3_joint <- m[["fit"]]@.MISC[["summary"]][["rhat"]][[3]] #Why are there three?
  data_i$Ess_1_joint <- m[["fit"]]@.MISC[["summary"]][["ess"]][[1]]
  data_i$Ess_2_joint <- m[["fit"]]@.MISC[["summary"]][["ess"]][[2]]
  data_i$Ess_3_joint <- m[["fit"]]@.MISC[["summary"]][["ess"]][[3]] #Why are there three?
  
  #Insert into permanent data frame
  if (n == 1){
    Results <- data_i
  } else {
    Results <- rbind(Results, data_i)
  }
  
#Adding to the number of iterations
n = n + 1
  
}

```



#Partial pooling
We need to transform this to long data in order to do partial pooling, maybe Signe can do her magic. 

We need one column containing answer from both keft and right in order to allow pooling between all participants

```{r making long format, include = FALSE}
#take just the columns we need
L_data <- subset(data, select = c(GroupNumber, SubjectID_right, SubjectID_left, Gender_left, Gender_right, Familiarity, dif_blue, left_answer, right_answer, joint_answer ))


#change to long format 

L_data <- melt(data, 
                     variable.name = "Position",
                     value.name = "Subject",
                     id.vars = c("GroupNumber", "Gender_left", "Gender_right", "Familiarity", "dif_blue", "left_answer", "right_answer", "joint_answer"))

```

When we have the long format, we can do a model with partial pooling: get_prior(answer ~ dif_blue + unique_ID, data = data)

A consideration: Should we allow different slopes for the same participant in different groups? 
```{r creating model with partial pooling}

#Getting priors
get_prior(answer ~ dif_blue + unique_ID, data = data)

#Defining priors
prior =  c(
  prior(normal(0,2), class = "Intercept"), 
  prior(normal(0,2), class = "sigma"), #Why does this not work? 
  prior(normal(0,2), class = "b"), 
  prior(normal(0,1), class = "b", coef = "dif_blue"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left29_Emma"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left28_Amalie"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left27_Esben"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left26_Simon"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left25_Esben"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left24_Toby"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left23_laura"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left22_Karoline"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left21_laura"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left20_Fred"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left2_Oliver"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left19_SigneR"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left18_SigneR"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left17_Fred"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left16_Sara"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left15_Malte"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left14_kenneth"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left13_Sara"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left12_Telma"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left11_andersweile"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left10_andersweile"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left3_Britta"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left30_Jan"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left31_Emma"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left32_Theasmom"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left33_Ane"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left34_Magnus"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left35_Magnus"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left36_Ane"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left37_larsk"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left38_annas"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left39_larsk"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left4_Michael"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left40_andersh"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left5_stephanie"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left6_nina"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left7_stephanie"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left8_mikkel"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_left9_Matilde"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right30_John"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right3_Katrine"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right29_Theasmom"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right28_Astrid"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right27_Simon"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right26_Astrid"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right25_Amalie"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right24_Lasse"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right23_Karoline"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right22_Lasse"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right21_Toby"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right20_Ida"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right2_Britta"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right19_seb"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right18_Ida"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right17_seb"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right16_signekirk"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right15_kenneth"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right14_signekirk"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right13_Malte"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right12_simonmoller"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right11_Matilde"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right10_simonmoller"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right31_Jan"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right32_John"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right33_Laurits"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right34_Nanna"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right35_Laurits"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right36_Nanna"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right37_andersh"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right38_anneed"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right39_annas"), 
  prior(normal(0,1), class = "b", coef = "unique_ID_right4_Katrine"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right40_anneed"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right5_mikkel"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right6_emil"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right7_nina"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right9_Telma"),
  prior(normal(0,1), class = "b", coef = "unique_ID_right8_emil")
 )
  
#Prior predictive check
  prior_check <- brm( left_answer ~ dif_blue, prior = prior,
           data = data_i, sample_prior = "only",iter = 4000, family = "bernoulli")

#Making the model
  m <- brm(
    left_answer ~ dif_blue + ,
    data = data_i,
    prior = prior,
    family = "bernoulli", #As we had a binary outcome, we set this to "bernoulli"
    seed = 123 # Adding a seed makes results reproducible.
  ) 
  
   summary(m)
  

```


#Calculating performance difference

INDS?T DET SIGNE SKREV TIRSDAG

#Model
```{r}

```



- logistic regression individuals and joint - plot 
- calculate equality bias (best/worst)
- calculate collaborative bias (joint/best)